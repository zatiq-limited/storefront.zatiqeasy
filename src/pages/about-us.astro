---
/**
 * ========================================
 * ABOUT PAGE
 * ========================================
 *
 * Fetches data from API and renders sections dynamically
 * Uses BlockRenderer for V3.0 Schema rendering
 *
 * Backend API Endpoint: GET /api/storefront/v1/page/about-us
 */

import Layout from '../layouts/main.astro';
import BlockRenderer from '../components/BlockRenderer';
import { getAboutPageData } from '../lib/api-client';

// Fetch about page data from API
const aboutPageData = await getAboutPageData();

// Handle null case and extract data
const pageData = aboutPageData?.data || aboutPageData || {};
const { template = 'about', sections = [], seo = {} } = pageData;
---

<Layout
	title={seo?.title || 'About Us'}
	description={seo?.description}
	image={seo?.og?.image}
>
	<main class="zatiq-about-page">
		{
			sections.map((section: any) => {
				// Get the first block from each section (which contains the actual structure)
				const block = section.blocks?.[0];
				if (!block || !section.enabled) return null;

				return (
					<BlockRenderer block={block} data={block.data || {}} client:load />
				);
			})
		}
	</main>
</Layout>
